\section{Задача №1.}
\subsection{Постановка задачи.}
Рассмотри разгон жидкости в плоском канале (Рис. \ref{fig:1}). Разгон происходит за счет действия градиента давления ($\frac{1}{\rho}\frac{\partial{p}}{\partial{x}}$).

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{images/1.png}
    \caption{Схема расчетной области.}
    \label{fig:1}
\end{figure}

Исследуемое течение описывается уравнением (\ref{eq:1}), где $\frac{1}{\rho}\frac{\partial p}{\partial x}=A, [\text{м/с}^2]$ - амплитуда;
$\nu, [\text{м}^2/\text{с}]$ - коэффициент кинематической вязкости; $h, [\text{м}]$ - высота зазора; $u(y,t), \text{м/с}$ - скорость жидкости в точке $(y)$ в момент времени $(t)$; $y, [\text{м}]$ - координата вдоль сечения; $t, \text{с}$ - время.    

\begin{equation}
    \frac{\partial u}{\partial t}-\frac{\partial}{\partial y} \left( \nu \frac{\partial u}{\partial y} \right)-\frac{1}{\rho}\frac{\partial p}{\partial x} = 0
\label{eq:1}
\end{equation}

Начальные условия для задачи - уравнение (\ref{eq:2}). 

Граничные условия для задачи - уравнение (\ref{eq:3}).

\begin{equation}
    u(y,0) = 0
\label{eq:2}
\end{equation}

\begin{equation}
    u(0,t) = 0 ~~~~~~u(h,t) = 0
\label{eq:3}
\end{equation}

В данной задаче нам требуется: рассчитать утановившееся течение; оценить за какой интервал времени оно станет установившимся;
расчитать течение при различных значениях $A$; построить зависимость максимальной скорости при установившемся течении от $A$.

\subsection{Описание используемых численных методов.}

Для решения поставленной задачи воспользуемся двумя схемами численных методов:
\begin{itemize}
    \item Явная центральная схема.
    \item Явная центральная схема с компенсацией старшего слагаемого ошибки аппроксимации.
\end{itemize}

\subsection{Явная центральная схема.}
Разобьем интервал $[0,h]$ на $N$ узлов с координатами $y_i, i=[1,N]$. Также будет двигаться по временным слоям с шагом по времени $\Delta t$, тогда получим $t^n = n \cdot \Delta t$. 
Будем считать значение на новом слое, основываясь на значении на предыдщуем слое, а также двух соседних точек предыдущего слоя. Граничные условия помогут заполнить значения для крайних узлов интервала. (Рис. \ref{fig:2})
\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{images/2.png}
    \caption {Шаблон явной центральной схемы.}
    \label{fig:2}
\end{figure}

Аппроксимируем первую производную по времени и вторую по координате, используя ограничение на шаг аппроксимации по времени - $\Delta t \leq \frac{\Delta x^2}{2\nu}$. 
Такое ограничение вводится с целью сохранения устойчивости схемы, как раз таки из-за этого ограничения вычисления при помощи данной схемы являются ресурсоемкими. Это в свою очередь является большим минусом.
Схема аппроксимации представлена в уравнении (\ref{eq:4}).
Также отдельно рассмтарим случай, когда с целью повышения точности аппроксимации выберем такое $\Delta t \leq \frac{\Delta x^2}{6\nu}$.

\begin{equation}
    \frac{u^{n+1}_i-u^n_i}{\Delta t} - \nu \frac{u^n_{i-1}-2u^n_i+u^n_{i+1}}{\Delta y^2} - A =0
    \label{eq:4}
\end{equation}

Теперь аппроксимируем начальные и граничные условия, учитывая, что мы используем N узлов - НУ: $u^1_i = 0, i=[1,N]$; ГУ: $u^n_1 = 0, n - \text{любое} $ $u^n_N = 0, n - \text{любое}$. 

\subsection{Явная центральная схема с компенсацией старшего слагаемого ошибки аппроксимации.}
При использовании явной схемы возникает накапливающаяся ошибка, которая может вредить решению, чтобы этого избежать требуется ее компенсировать. Это нам позволяет разложение функции в ряд Тейлора и отбрасывание величин большего порядка малости, чем в обычной явной схеме. Отсюда у нас появляется еще одно слагаемое. Уравнение данной схемы представлено в уравнении (\ref{eq:5}).
\begin{equation}
    \frac{u^{n+1}_i-u^n_i}{\Delta t} - \nu \frac{u^n_{i-1}-2u^n_i+u^n_{i+1}}{\Delta y^2} + \left[-\frac{\nu^2 \Delta t}{2} + \frac{\nu \Delta y^2}{12} \right] \frac{u^n_{i+2}-4u^n_{i+1}+6u^n_i-4u^n_{i-1}+u^n_{i-2}}{\Delta y^4} = A
\label{eq:5}
\end{equation}

Аппроксимация производных, а также граничных и начальных условий аналогичны явный центральной схеме. Шаблон схемы с учетом старшего слагаемого ошибки аппроксимации представлен на Рис. \ref{fig:3}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{images/3.png}
    \caption {Шаблон явной центральной схемы с компенсацией.}
    \label{fig:3}
\end{figure}

Но что происходит на границе области, когда мы должны воспользовать для расчетом точками. кторые выходят из нашего диапазона? Введем минимые точки $u^n_0$ и $u^n_{N+1}$. Которые определяются из граничных условий для крайних точек области, а именно: $\frac{\partial^2 u}{\partial y^2}\vert_{y=0,h}=0$. Аппроксимируем данное условие и получим следующее:
\begin{equation}
    \frac{u^n_0-2u^n_1+u^n_2}{\Delta y^2}=0
\label{eq:6}
\end{equation} 

\begin{equation}
    \frac{u^n_{N+1}-2u^n_N+u^n_{N-1}}{\Delta y^2}=0
\label{eq:7}
\end{equation}

Откуда мы найдем значения для наших точек на $n$ слое.


\subsection{Реализация численного метода.}
Реализуем численный метод, используя язык программирования Fortran. Программа автоматически считывает из текстового файла константы, использующиеся при вычислении скорости на новом временном слое.
Затем она инициализирует начальные условия заданные в программе и начинает итерационно идти вдоль временной координаты, доходя до слоя, в котором значение времени равно времени, заданному предварительно (время, в которое мы хотим получить распределение скорости).
Производится подсчет каждого последующего временного слоя и после достижения заданного времени выводятся значения слоя в документ. Блок схема программы представлена на Рис. \ref{fig:4}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{images/4.png}
    \caption {Блок схема программы реализующей численный метод.}
    \label{fig:4}
\end{figure}

\subsection{Реализуемый вариант расчетов.}
Будем рассматривать задачу для следующих вводных параметров:
\begin{itemize}
    \item $h=0.01$м - высота зазора
    \item $\nu = 1.e-6 \text{м}^2/\text{с}$  - кинематическая вязкость
    \item $Time = 100$ с - рассматриваемое время течения
    \item $A=0.3 \text{м}/\text{с}^2$ - амплитуда
    \item $Ny = 100$ - количество узлов
\end{itemize}

\subsection{Результаты расчетов.}
Расчитанное установившееся течение представлено на Рис. \ref{fig:5} (используем визуализатор gnuplot).
Ввиду того, что отличие между схемами является малым, приблизим участок в середине сечения, чтобы визуально наблюдать различия. (Рис. \ref{fig:6})
\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{images/5.png}
    \caption {Профиль скорости установившегося течения.}
    \label{fig:5}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{images/6.png}
    \caption {Различие между двумя схемами.}
    \label{fig:6}
\end{figure}

Из Рис. \ref{fig:6} можем наблюдать, что схемы отличают на значение порядка $10^{-3}$, что говорит о малом их различии.

Время установления течения для явной схемы без компенсации $T_\text{уст}=66.1 \text{с}$, а для схму с учетом компенсации $T_\text{уст}=65.0 \text{с}$. 
Рассмотрим различные значения $A$ и построим для них профили скорости. (Рис. \ref{fig:7}) Как мы можем наблюдать чем больше значение A, тем выше максимум нашей параболы Пуазейля. Действительно, A - ускорение, которое прикладывается к потоку и чем оно больше, тем больше сила, действующая на него, а значит и поток достигает большей скорости, перед тем, как за счет сил сопротивления компенсировать эту движущую силу. 

\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{images/7.png}
    \caption {Графики профиля скорости в зависимости от параметра $A$.}
    \label{fig:7}
\end{figure}

Построим зависимость максимальной скорости от значения параметра $A$. График зависимости представлен на Рис. \ref{fig:8}. Из графика видно, что зависимость максимальной скорости от параметра $A$ является линейной. 
\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{images/8.png}
    \caption {Графики профиля скорости в зависимости от параметра $A$.}
    \label{fig:8}
\end{figure}

Сопоставим результат полученный с помощью данных схем и аналитическое решение. Аналитическое решение описывается уравнением (\ref{eq:8}).
Визуализация полученных профилей представлена на Рис. \ref{fig:9}.

\begin{equation}
    u=\frac{A}{2\nu} (R^2-r^2), \text{где R=h/2, r=|y-h/2|}
\label{eq:8}
\end{equation}


\begin{figure}[H]
    \centering
    \subcaptionbox{Без увеличения.}{\includegraphics[width=0.4\textwidth]{images/9.png}}
    \hfill 
    \subcaptionbox{Масштабирование на пике.}{\includegraphics[width=0.4\textwidth]{images/10.png}}
    \caption{Сравнение аналитического и численно полученного профилей скорости.}
    \label{fig:9}
\end{figure}

Отличие аналитического решения от численного для обеих схем составляет порядка $\delta = 0.006\%$ - максимальное отклонение численного решения от аналитического (\ref{eq:9}).

\begin{equation}
    \delta = max\left| \frac{u_i^\text{числ}-u^\text{теор}(y_i)}{u^\text{теор}(y_i)}\right|
\label{eq:9}
\end{equation}

Рассмотрим случай $\Delta t = \frac{\Delta y^2}{6\nu}$ повышающий аппроксимацию. Порядок точности будем определять по максимальному значению скорости вычисленному с помощью численных методов и аналитически.  (Таблица. \ref{tab:1})

% Please add the following required packages to your document preamble:
% \usepackage{graphicx}
\begin{table}[H]
    \centering
    \resizebox{0.35\textwidth}{!}{%
    \begin{tabular}{|c|c|c|c|}
    \hline
         & Теор.   & $\Delta t = \frac{\Delta y^2}{6\nu}$      & $\Delta t = \frac{\Delta y^2}{2\nu}$      \\ \hline
    $V_{max}$ & 3.75000 & 3.74963 & 3.74918 \\ \hline
    \end{tabular}%
    }
\caption{Сравнение точности повышающего порядок аппроксимации схемы.}
\label{tab:1}
\end{table}


\subsection{Вывод.}
\begin{itemize}
    \item Явная центральная схема без и с компенсацией старшего слагаемого ошибки аппроксимации отличаются друг от друга на порядок $10^{-3}$, что говорит нам о том, что данные схемы идентичны и дают одинаково точные результаты.
    \item Полученные профили скорости совпадают с теоритическими расчетами с относительной погрешность максимального отклонения $\delta = 0.006\%$.
    \item При увеличении параметра амплитуда $A$ максимальная скорость утсановишегося течения растет, причем ее рост является линейным. (Рис. \ref{fig:8})
    \item Полученные профили описывают параболу Пуазейля.
\end{itemize}

\section{Задача №2.}
\subsection{Постановка задачи.}
Рассмотрим задачу переноса синусоидального сигнала с гармоникой: $$\sin(kx),~ \text{где}~ k=\frac{m\pi}{L}; ~m=2; ~L=1, ~\text{тогда}~ y(x)=\sin(2\pi x)$$
А также сигнала описываемого кусончной функцией: 
\begin{equation}
    f(x)=
    \begin{cases}
        1, ~\text{при}~ x<0.4 \\
        5x-3,~ \text{при}~ 0.4 \leq x \leq 0.8 \\
        1, ~\text{при}~ x>0.8 \\
    \end{cases}
\end{equation}
С помощью метода конечных разностей найдем численное решение для одномерного линейного уравнения переноса:
$$\frac{\partial u}{\partial t}+c \frac{\partial u}{\partial x}=0$$
Для аппроксимации уравнения рассмотрим два способа: явную противопоточную схему первого порядка и схема "Кабарэ". 
\subsection{Явная противопоточная схема.}
Схема с разностями против потока в вычислительной физике — класс методов дискретизации для решения (явными схемами) дифференциальных уравнений в частных производных гиперболического типа (гиперболических уравнений).

\begin{equation}
    \frac{u_i^{n+1}-u_i^n}{\Delta t}+\frac{c+|c|}{2}\frac{u_i^n-u_{i-1}^n}{\Delta x}+\frac{c+|c|}{2}\frac{u_{i+1}^n-u_{i}^n}{\Delta x}=0
\end{equation}

Схема с разностями против потока неявно вводит в уравнение искусственную вязкость, которую часто
называют неявной (схемной) искусственной вязкостью в отличие
от явной искусственной вязкости, которая преднамеренно вводится в разностное уравнение. Искусственная вязкость сглаживает
решение уравнения, уменьшая градиенты всех параметров независимо от причины возникновения этих градиентов, физической или вычислительной. Такое свойство разностной схемы, обусловленное наличием в выражении для погрешности аппроксимации производных четного порядка, называют диссипацией на разностной
сетке.
Другое близкое к физическому свойство разностных схем называют дисперсией. Оно непосредственно связано с производными
нечетного порядка в выражении для погрешности аппроксимации.
Дисперсия приводит к искажению соотношения фаз различных
волн. Совместное воздействие диссипации и дисперсии на решение иногда называют диффузией. Диффузия приводит к растяжению крутых линий раздела, которые могут появляться в расчетной
области.
\begin{equation}
    u_i^{n+1}=u_i^n-\frac{\Delta t}{2 \Delta x} ((C+|C|)(u_i^n-u_{i-1}^n)+(C-|C|)(u_{i+1}^n-u_i^n))
\end{equation}
Шаблон схемы аналогичен явной центральной схеме (Рис. \ref{fig:2})
\subsection{Схема Кабарэ}
Схема Кабаре является бездиссипативной и обладает улучшенными по сравнению с
классическими линейными схемами дисперсионными свойствами. Она устойчива при положительных числах Куранта, не превышающих единицу, и точна при числах Куранта 0.5 и 1. Шаблон схемы представлен на Рис. \ref{fig:10}
\begin{equation}
    \frac{1}{2}\left(\frac{u_i^{n+1}-u_i^n}{\Delta t}+\frac{u_{i-1}^{n}-u_{i-1}^{n-1}}{\Delta t}\right) +c \frac{u_i^{n}-u_{i-1}^n}{\Delta x}=0
\end{equation}
\begin{equation}
    u^{n+1}_i=u^n_i-u^n_{i-1}+u^{n-1}_{i-1}-2c\frac{\Delta t}{\Delta x}(u^n_i-u^n_{i-1})
\end{equation}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.2\textwidth]{images/11.png}
    \caption{Шаблон разностной схемы Кабарэ.}
    \label{fig:10}
\end{figure}

\subsection{Реализация численных методов.}
Реализуем численные методы, используя язык программирования Fortran. Для схемы Кабарэ, первую итерацию будем производить по явной противопоточной схеме. Блок схема программы представлена на Рис. \ref{fig:4}
\subsection{Результаты расчетов.}
\subsubsection{Синусоидальный сигнал.}
На Рис. \ref{fig:11} представлены графики синусоидального сигнала в два различных момента времени вычисленных с помощью двух схем (на графике представлены аналитическое решение и численное).

\begin{figure}[H]
    \centering
    \subcaptionbox{Явная противопоточная схема. t=15}{\includegraphics[width=0.4\textwidth]{images/12.png}}
    \hfill
    \subcaptionbox{Схема Кабаре. t=15}{\includegraphics[width=0.4\textwidth]{images/13.png}}
    \hfill
    \caption{Вид сигнала расчитанного с помощью различных схем.}
    \label{fig:11}
\end{figure}

Как мы можем видеть, амплитуда расчитанного численное сигнала с помощью явной противопоточной схемы уменьшилась. Это связано с  

\section{Код программ.}
Код программ представлен в удаленном репозитории на GitHub \\ (https://github.com/MrDionisio/CFD)
